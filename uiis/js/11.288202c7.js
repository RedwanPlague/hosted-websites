(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"530e":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.info?e("div",{staticClass:"q-pa-sm column items-center"},[e("h6",[t._v("\n    "+t._s(t.info.courseID+" ("+t.info.courseTitle+") - Part "+t.info.part)+"\n  ")]),t.canSave?e("q-checkbox",{attrs:{label:"Edit"},model:{value:t.canEdit,callback:function(s){t.canEdit=s},expression:"canEdit"}}):t._e(),e("q-table",{staticClass:"table",attrs:{title:"Marks",data:t.students,columns:t.columns,"row-key":"studentID",separator:"cell","table-header-class":"bg-primary text-white"},scopedSlots:t._u([{key:"body",fn:function(s){return[e("q-tr",{class:{bhul:t.info.hasForwarded&&s.row.editAccess},attrs:{props:s}},[e("q-td",{key:"studentID",attrs:{props:s}},[t._v("\n          "+t._s(s.row.studentID)+"\n        ")]),e("q-td",{key:"mark",attrs:{props:s}},[e("q-input",{attrs:{type:"number",value:s.row.mark,disable:!t.canEdit||!s.row.editAccess},on:{change:function(e){return t.updateMarks(e,s.row.studentID)}}})],1)],1)]}}],null,!1,1942375983)}),e("div",{staticClass:"btns"},[t.canSave?e("q-btn",{staticClass:"q-ma-md",attrs:{color:"primary",label:"Save"},on:{click:t.saveMarks}}):t._e(),t.info.hasForwarded?t._e():e("q-btn",{staticClass:"q-ma-md",attrs:{color:"primary",label:"Submit"},on:{click:t.submitMarks}})],1)],1):e("div",[t._v(t._s(t.info))])},o=[],r=e("ded3"),i=e.n(r),n=(e("ddb0"),e("2f62")),l=e("758b"),u={name:"ExaminerTable",data(){return{loading:!0,canEdit:!1,probRolls:[],columns:[{name:"studentID",label:"Student ID",field:"studentID",required:!0,align:"left",sortable:!0},{name:"mark",label:"Mark",field:"mark",align:"left"}]}},methods:{updateMarks(t,s){this.$store.commit("examiner/mutSingleMark",{studentID:s,mark:Number(t.target.value)}),console.log(this.students)},async uploadMarks(t){try{const s=this.info.courseID,e=this.currentSession,a=this.info.part;if(this.probRolls=[],this.info.students.forEach((t=>{console.log(t.studentID),console.log(t.mark),console.log(this.info.totalMarks),(t.mark<0||t.mark>this.info.totalMarks)&&this.probRolls.push(t.studentID)})),console.log(this.probRolls),this.probRolls.length)return this.$q.notify({icon:"error",message:`Please recheck the marks of ${this.probRolls.join()}!`,position:"bottom-left",actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]}),!1;const o=this.info.students.map((t=>({studentID:t.studentID,mark:t.mark?t.mark:null}))),r="save"===t?"saved!":"forwarded!",i="save"===t?"saving!":"forwarding!",n=this.$q.notify({spinner:!0,message:i,group:!1,timeout:0,position:"bottom-left"}),u=await l["b"].put(`teacher/examiner/${s}/${e}/${t}`,{part:a,students:o});return console.log(u),n({icon:"done",message:r,position:"bottom-left",spinner:!1,timeout:1500}),!0}catch(s){}},async saveMarks(){await this.uploadMarks("save")},async submitMarks(){const t=await this.uploadMarks("forward");t&&this.$store.commit("examiner/mutHasForwarded")}},computed:i()(i()({},Object(n["d"])("examiner",{info:"currentCourseInfo",currentSession:"currentSession"})),{},{students(){return console.log(this.info.students),this.info.students?this.info.students:[]},canSave(){for(const t of this.students)if(t.editAccess)return!0;return!1}}),watch:{async"$route.params"(t,s){this.$route.params.courseID&&this.$route.params.part&&(this.$store.commit("examiner/mutCurCourse",this.$route.params.courseID),this.$store.commit("examiner/mutCurPart",this.$route.params.part),this.loading=!0,this.$q.loading.show({delay:100}),this.courseLoading=!0,await this.$store.dispatch("examiner/fillCurrentCourse"),this.courseLoading=!1,consoloe.log(this.students),this.$q.loading.hide(),this.loading=!1)},info(t){this.loading=!1}},async created(){this.$q.loading.show({delay:100}),this.loading=!0,this.info||await this.$store.dispatch("examiner/fillCourses"),this.$store.commit("examiner/mutCurCourse",this.$route.params.courseID),this.$store.commit("examiner/mutCurPart",this.$route.params.part),await this.$store.dispatch("examiner/fillCurrentCourse"),this.loading=!1,this.$q.loading.hide()}},c=u,d=(e("a4f3"),e("2877")),m=e("8f8e"),h=e("eaac"),p=e("bd08"),f=e("db86"),b=e("27f9"),k=e("9c40"),g=e("eebe"),w=e.n(g),$=Object(d["a"])(c,a,o,!1,null,"f725196a",null);s["default"]=$.exports;w()($,"components",{QCheckbox:m["a"],QTable:h["a"],QTr:p["a"],QTd:f["a"],QInput:b["a"],QBtn:k["a"]})},"71d7":function(t,s,e){},a4f3:function(t,s,e){"use strict";e("71d7")}}]);