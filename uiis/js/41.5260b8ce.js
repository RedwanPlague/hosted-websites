(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"365b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"text-h5 q-mb-md"},[e._v("\n    Departments\n  ")]),e.dataLoading?e._e():a("q-form",{on:{submit:e.updateDepartments,reset:e.resetForm}},[e._l(e.departments,(function(t,n){return a("div",{key:n,staticClass:"row q-col-gutter-md q-mb-sm"},[a("q-input",{staticClass:"col-2",attrs:{label:"Department ID",outlined:"",readonly:t.old,rules:[function(){return!!t.id||"Please Enter Department ID"}]},model:{value:t.id,callback:function(a){e.$set(t,"id",a)},expression:"dept.id"}}),a("q-input",{staticClass:"col-5",attrs:{label:"Name",rules:[function(){return!!t.name||"Please Enter Name"}],outlined:"",readonly:t.viewing},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"dept.name"}}),a("teacher-picker",{attrs:{classes:"col-4",label:"Head",readonly:t.viewing},model:{value:t.head,callback:function(a){e.$set(t,"head",a)},expression:"dept.head"}}),a("div",{staticClass:"col-1"},[t.old?a("q-btn",{attrs:{icon:t.viewing?"edit":"visibility",color:t.viewing?"primary":"black",flat:"",dense:""},on:{click:function(e){t.viewing=!t.viewing}}}):a("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.localRemoveDepartment(n)}}})],1)],1)})),e.canCreate?a("div",{staticClass:"row"},[a("div",{staticClass:"col-3"}),a("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.localAddDepartment}})],1):e._e(),a("div",{staticClass:"col-12 q-mt-lg"},[a("q-btn",{attrs:{label:"Update",type:"submit",color:"primary",unelevated:""}}),a("q-btn",{attrs:{label:"Reset",type:"reset",color:"primary",flat:""}})],1)],2),a("q-inner-loading",{attrs:{showing:e.dataLoading}})],1)},i=[],s=a("ded3"),d=a.n(s),r=a("dce8"),l=a("e92d"),c=a("7338"),o=a("88f5"),m=a("b2c5"),p=a("2f62"),u=a("c9d9"),h={name:"DeptManagement",components:{TeacherPicker:l["a"]},mixins:[c["a"],o["a"]],data(){return{departments:[],deptList:[],dataLoading:!1}},computed:d()(d()({},Object(p["d"])(["userHasPrivilege"])),{},{canCreate(){return this.userHasPrivilege(u["d"].DEPARTMENT_CREATION)},canUpdate(){return this.userHasPrivilege(u["d"].DEPARTMENT_UPDATE)}}),methods:{fetchDepartments(){this.dataLoading=!0,Object(r["a"])("/department/list",null,"Departments").then((e=>{this.dataLoading=!1,this.deptList=e.data,this.resetForm()})).catch((()=>{this.dataLoading=!1}))},localAddDepartment(){this.departments.push({id:null,name:null,head:null,viewing:!1,old:!1})},localRemoveDepartment(e){this.departments.splice(e,1)},updateDepartments(){this.departments.forEach(((e,t)=>{if(e.old){const a=this.deptList[t];a.name===e.name&&e.head&&a.head===e.head.value||this.editDepartment(e)}else this.createDepartment(e)}))},createDepartment(e){this.callCreateApi("/department/create",{id:e.id,name:e.name,head:Object(m["a"])(e.head)},`${e.id} department`).then((()=>{const t=this.departments.find((t=>t.id===e.id));t.viewing=!0,t.old=!0}))},editDepartment(e){this.callEditApi("/department/update/"+e.id,{name:e.name,head:Object(m["a"])(e.head)},`${e.id} department`).then((()=>{const t=this.departments.find((t=>t.id===e.id));t.viewing=!0}))},resetForm(){this.departments=this.deptList.map((e=>d()(d()({},e),{},{viewing:!0,old:!0})))}},created(){this.fetchDepartments()}},v=h,b=a("2877"),g=a("9989"),f=a("0378"),D=a("27f9"),w=a("9c40"),q=a("74f7"),C=a("eebe"),k=a.n(C),y=Object(b["a"])(v,n,i,!1,null,null,null);t["default"]=y.exports;k()(y,"components",{QPage:g["a"],QForm:f["a"],QInput:D["a"],QBtn:w["a"],QInnerLoading:q["a"]})}}]);