(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{"42a4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"text-h5 q-my-md"},[e._v("\n    Search Fines\n  ")]),a("div",{staticClass:"row q-col-gutter-md"},[a("q-input",{staticClass:"col-6",attrs:{label:"Student ID",outlined:"",rules:[function(){return!!e.id||"Please Enter Student ID"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{icon:"search",flat:"",color:"primary",disable:!e.id},on:{click:e.loadFines}})]},proxy:!0}]),model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1),e.showResults?a("div",{staticClass:"q-mt-lg"},[a("q-separator",{staticClass:"q-my-sm"}),a("q-table",{attrs:{title:"Results",data:e.tableData,columns:e.columns,flat:"","wrap-cells":"","row-key":"_id","selected-rows-label":e.getSelectedString,selected:e.selected,selection:"multiple"},on:{"row-click":e.onRowClick,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"header-selection",fn:function(t){return[a("q-checkbox",{on:{input:e.onSelect},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"scope.selected"}})]}},{key:"body-selection",fn:function(t){return[t.row.status===e.DUE_STATUS.PENDING?a("q-checkbox",{model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"scope.selected"}}):e._e()]}},{key:"body-cell-status",fn:function(t){return[a("q-td",{style:{color:t.value===e.DUE_STATUS.PENDING?"red":"green"},attrs:{props:t}},[e._v("\n          "+e._s(t.value)+"\n        ")])]}},{key:"body-cell-description",fn:function(t){return[a("q-td",{attrs:{props:t}},[e._v("\n          "+e._s(t.value)+"\n          "),a("q-tooltip",{attrs:{"content-style":"font-size: 1.1em; background-color: black","max-width":"50vw"}},[e._v("\n            "+e._s(t.row.description)+"\n          ")])],1)]}}],null,!1,3638020136)}),a("q-btn",{attrs:{label:"Clear Selected",color:"primary",unelevated:"",loading:e.clearLoading,disable:0===e.selected.length},on:{click:e.clearFines}})],1):e._e(),a("q-inner-loading",{attrs:{showing:e.searchLoading}}),a("div",{staticStyle:{"min-height":"200px"}})],1)},l=[],s=(a("498a"),a("4e82"),a("c9d9")),i=a("d255"),c=a("a688");const o=e=>`à§³ ${e}`,r=e=>new Intl.DateTimeFormat("en",{month:"short",day:"numeric",year:"numeric"}).format(new Date(e)),d=20,u=e=>e.slice(0,d).trim()+(e.length>d?"...":""),m=[{name:"fineType",label:"Fine Type",field:"fineType",align:"center"},{name:"amount",label:"Initial Amount",field:"amount",align:"center",format:o},{name:"deadline",label:"Deadline",field:"deadline",align:"center",format:r},{name:"delayFine",label:"Delay Fine",field:"delayFine",align:"center",format:o},{name:"currentAmount",label:"Current Amount",field:"currentAmount",align:"center",format:o},{name:"status",label:"Status",field:"status",align:"center",sortable:!0},{name:"description",label:"Description",field:"description",align:"center",format:u}],h={style:"font-size: 1.02em;",headerStyle:"font-size: 1.02em;"};Object(i["a"])(m,h);var p={name:"FineSearch",mixins:[c["a"]],data(){return{id:null,clearLoading:!1,selected:[],DUE_STATUS:s["a"],columns:m}},computed:{selectedIDs(){return this.selected.map((e=>e._id))}},methods:{getSelectedString(){return 0===this.selected.length?"":`${this.selected.length} record${this.selected.length>1?"s":""} selected of ${this.tableData.length}`},onSelect(){this.selected=this.selected.filter((e=>e.status===s["a"].PENDING))},loadFines(){this.callSearchApi("/fine/list/"+this.id,{},"Fine").then((()=>this.tableData=this.tableData.sort(((e,t)=>e.status>t.status?-1:1))))},clearFines(){this.clearLoading=!0,this.$adminAPI.post("/fine/clear",{ids:this.selected.map((e=>e._id))}).then((()=>{this.clearLoading=!1,this.tableData=this.tableData.map((e=>(this.selectedIDs.includes(e._id)&&(e.status=s["a"].CLEARED),e))),this.selected=[]})).catch((()=>{this.clearLoading=!1,this.$q.notify({message:"Failed to clear selected fines",type:"negative"})}))},onRowClick(e,t){const a=this.$router.resolve({name:"AdminFineEditPage",params:{fineID:t._id}});window.open(a.href,"_blank")}}},f=p,b=a("2877"),g=a("9989"),y=a("27f9"),S=a("9c40"),w=a("eb85"),D=a("eaac"),k=a("8f8e"),_=a("db86"),v=a("05c0"),q=a("74f7"),F=a("eebe"),I=a.n(F),T=Object(b["a"])(f,n,l,!1,null,null,null);t["default"]=T.exports;I()(T,"components",{QPage:g["a"],QInput:y["a"],QBtn:S["a"],QSeparator:w["a"],QTable:D["a"],QCheckbox:k["a"],QTd:_["a"],QTooltip:v["a"],QInnerLoading:q["a"]})}}]);