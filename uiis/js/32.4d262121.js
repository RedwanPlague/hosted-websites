(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{"857f":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"text-h5 q-my-md"},[t._v("\n    Edit Course Details\n  ")]),s("div",{staticClass:"row q-col-gutter-md"},[s("course-picker",{attrs:{classes:"col-6",label:"Course to Edit",required:"","only-offered":""},on:{input:t.loadCourseSessionData},model:{value:t.courseToEdit,callback:function(e){t.courseToEdit=e},expression:"courseToEdit"}}),s("session-field",{attrs:{classes:"col-5",label:"Session",required:"",readonly:""},model:{value:t.sessionToEdit,callback:function(e){t.sessionToEdit=e},expression:"sessionToEdit"}}),t.courseToEdit?s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"refresh",size:"lg",dense:"",flat:""},on:{click:t.loadCourseSessionData}})],1):t._e()],1),t.courseDataLoaded&&t.courseToEdit?s("q-form",[t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_UPDATE)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Evaluation Details","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-mb-md q-pt-md"},[s("q-input",{staticClass:"col-6",attrs:{label:"Total Evaluation Count",type:"number",outlined:"",rules:[function(){return!!t.totalEvalCount||"Please Fill this Field"}]},model:{value:t.totalEvalCount,callback:function(e){t.totalEvalCount=e},expression:"totalEvalCount"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Considered Evaluation Count",type:"number",outlined:"",rules:[function(){return!!t.consideredEvalCount||"Please Fill this Field"}]},model:{value:t.consideredEvalCount,callback:function(e){t.consideredEvalCount=e},expression:"consideredEvalCount"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Total Marks",type:"number",outlined:"",rules:[function(){return!!t.totalMarks||"Please Fill this Field"}]},model:{value:t.totalMarks,callback:function(e){t.totalMarks=e},expression:"totalMarks"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Per Evaluation Weight",type:"number",outlined:"",suffix:"%",rules:[function(){return!!t.perEvalWeight||"Please Fill this Field"}]},model:{value:t.perEvalWeight,callback:function(e){t.perEvalWeight=e},expression:"perEvalWeight"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Attendance Weight",type:"number",suffix:"%",outlined:"",rules:[function(){return!!t.attendanceWeight||"Please Fill this Field"}]},model:{value:t.attendanceWeight,callback:function(e){t.attendanceWeight=e},expression:"attendanceWeight"}})],1)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_ASSIGN_TEACHER)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Course Teachers","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[t._l(t.teachers,(function(e,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-7 row"},[s("span",{staticClass:"col-1 text-h6"},[t._v(t._s(a+1)+".")]),s("teacher-picker",{attrs:{classes:"col-11",label:"Teacher",required:""},model:{value:e.teacher,callback:function(s){t.$set(e,"teacher",s)},expression:"item.teacher"}})],1),s("q-input",{staticClass:"col-4",attrs:{label:"Evaluation Count",type:"number",max:t.totalEvalCount,min:0,outlined:"",rules:[function(){return!!e.evalCount||"Please Enter Evaluation Count"}]},model:{value:e.evalCount,callback:function(s){t.$set(e,"evalCount",s)},expression:"item.evalCount"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(e){return t.removeCourseTeacher(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:t.addNewCourseTeacher}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_ALLOT_SCHEDULE)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Fix Schedule","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[t._l(t.schedule,(function(e,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-5 row"},[s("span",{staticClass:"col-1 text-h6"},[t._v(t._s(a+1)+".")]),s("slot-picker",{attrs:{classes:"col-11"},model:{value:e.slot,callback:function(s){t.$set(e,"slot",s)},expression:"item.slot"}})],1),s("q-input",{staticClass:"col-3",attrs:{label:"Room",outlined:"",rules:[function(){return!!e.room||"Please Assign a Room"}]},model:{value:e.room,callback:function(s){t.$set(e,"room",s)},expression:"item.room"}}),s("day-of-week-picker",{staticClass:"col-3",attrs:{label:"Day of Week",required:""},model:{value:e.day,callback:function(s){t.$set(e,"day",s)},expression:"item.day"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(e){return t.removeSlot(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:t.addSlot}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_ASSIGN_EXAMINER)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Examiners","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[t._l(t.examiners,(function(e,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-5 row"},[s("span",{staticClass:"col-1 text-h6"},[t._v(t._s(a+1)+".")]),s("teacher-picker",{attrs:{classes:"col-11",label:"Examiner",required:""},model:{value:e.teacher,callback:function(s){t.$set(e,"teacher",s)},expression:"item.teacher"}})],1),s("q-input",{staticClass:"col-3",attrs:{label:"Part",outlined:"",rules:[function(){return!!e.part||"Please Assign a Part"}]},model:{value:e.part,callback:function(s){t.$set(e,"part",s)},expression:"item.part"}}),s("q-input",{staticClass:"col-3",attrs:{label:"Total Marks",outlined:"",rules:[function(){return!!e.totalMarks||"Please Assign a Part"}]},model:{value:e.totalMarks,callback:function(s){t.$set(e,"totalMarks",s)},expression:"item.totalMarks"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(e){return t.removeExaminer(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:t.addExaminer}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_ASSIGN_SCRUTINIZER)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Scrutinizers","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-pt-sm"},t._l(t.scrutinizers,(function(e,a){return s("div",{key:a,staticClass:"row col-4"},[s("teacher-picker",{attrs:{classes:"col-11",label:"Scrutinizer",required:""},model:{value:e.teacher,callback:function(s){t.$set(e,"teacher",s)},expression:"item.teacher"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(e){return t.removeScrutinizer(a)}}})],1)],1)})),0),s("div",{staticClass:"row q-pb-md"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:t.addScrutinizer}})],1)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),t.userHasPrivilege(t.PRIVILEGES.COURSE_SESSION_ASSIGN_INTERNAL)?s("div",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Internals","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-pt-sm"},t._l(t.internals,(function(e,a){return s("div",{key:a,staticClass:"row col-4"},[s("teacher-picker",{attrs:{classes:"col-11",label:"Internal",required:""},model:{value:e.teacher,callback:function(s){t.$set(e,"teacher",s)},expression:"item.teacher"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(e){return t.removeInternal(a)}}})],1)],1)})),0),s("div",{staticClass:"row q-pb-md"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:t.addInternal}})],1)]),s("q-separator",{staticClass:"q-mb-lg"})],1):t._e(),s("div",{staticClass:"col-12 q-mt-lg"},[s("q-btn",{attrs:{label:"Update",color:"primary",unelevated:"",loading:t.assignLoading},on:{click:t.updateCourseSession}}),s("q-btn",{attrs:{label:"Reset",color:"primary",flat:""},on:{click:t.resetForm}})],1)]):t._e(),s("q-inner-loading",{attrs:{showing:t.oldDataLoading}}),s("div",{staticStyle:{"min-height":"200px"}})],1)},l=[],i=s("ded3"),o=s.n(i),r=(s("ddb0"),s("29b9")),n=s("e92d"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{class:t.classes,attrs:{value:t.value,options:t.slotOptions,label:t.label,rules:[function(){return!t.required||!!t.value||"Please Select "+t.label}],"use-chips":t.multiple,multiple:t.multiple,clearable:t.multiple,outlined:""},on:{input:function(e){return t.$emit("input",e)}}})},u=[],d=s("dce8"),h=s("a796"),p=s("0286"),v={name:"SlotPicker",props:{label:{type:String,default:"Slot"},value:{type:[Object,Array,Number,String],default:null},classes:{type:[Object,String]},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},data(){return{slotOptions:[]}},methods:{fixValue(t){if("string"===typeof t||"number"===typeof t){const e=this.slotOptions.filter((e=>Object(p["d"])(e.value,t)))[0];this.$emit("input",e)}},fetchSlots(){Object(d["a"])("/slot/list",null,"Slots").then((t=>{this.slotOptions=t.data.map((t=>({value:t.id,label:`(${t.id}) ${Object(h["c"])(t.startingTime)} - ${t.duration} minutes`}))),this.fixValue(this.value)}))}},created(){this.fetchSlots()},watch:{value:{handler(t){this.fixValue(t)}}}},m=v,b=s("2877"),C=s("ddd8"),E=s("eebe"),f=s.n(E),g=Object(b["a"])(m,c,u,!1,null,"680ded20",null),S=g.exports;f()(g,"components",{QSelect:C["a"]});var q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{class:t.classes,attrs:{value:t.value,label:t.label,options:t.dayOptions,rules:[function(){return!t.required||!!t.value||"Please Select "+t.label}],"use-chips":t.multiple,multiple:t.multiple,clearable:t.multiple,outlined:""},on:{input:function(e){return t.$emit("input",e)}}})},k=[];const y=[{value:"sat",label:"Saturday"},{value:"sun",label:"Sunday"},{value:"mon",label:"Monday"},{value:"tue",label:"Tuesday"},{value:"wed",label:"Wednesday"},{value:"thu",label:"Thursday"},{value:"fri",label:"Friday"}];var x={name:"DayOfWeekPicker",props:{label:{type:String,default:"Day"},value:{type:[Object,Array,String],default:null},classes:{type:[Object,String]},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},data(){return{dayOptions:y}},methods:{fixValue(t){if("string"===typeof t){const e=this.dayOptions.filter((e=>e.value===t))[0];this.$emit("input",e)}}},created(){this.fixValue(this.value)},watch:{value:{handler(t){this.fixValue(t)}}}},I=x,D=Object(b["a"])(I,q,k,!1,null,"d176918e",null),O=D.exports;f()(D,"components",{QSelect:C["a"]});var _=s("567a"),P=s("88f5"),T=s("c9d9"),w=s("2f62");const W=(t,e)=>t.length>0?t[t.length-1]:e,$={teachers:"Course Teachers",schedule:"Course Schedule",examiners:"Examiners",internals:"Internals",scrutinizers:"Scrutinizers"},L={teachers:[{teacher:null,evalCount:null}],schedule:[{slot:null,room:null,day:null}],examiners:[{teacher:null,part:null,totalMarks:null}],internals:[{teacher:null}],scrutinizers:[{teacher:null}]};var A={name:"CourseAssignment",title:"Assign Course Details",components:{SessionField:_["a"],DayOfWeekPicker:O,SlotPicker:S,TeacherPicker:n["a"],CoursePicker:r["a"]},mixins:[P["a"]],data(){return{courseToEdit:null,sessionToEdit:null,courseDataLoaded:!1,totalEvalCount:null,consideredEvalCount:null,totalMarks:null,perEvalWeight:null,attendanceWeight:null,teachers:L.teachers,schedule:L.schedule,examiners:L.examiners,internals:L.internals,scrutinizers:L.scrutinizers,assignLoading:!1,PRIVILEGES:T["d"]}},computed:o()(o()({},Object(w["d"])(["userHasPrivilege"])),{},{courseID(){return this.courseToEdit?this.courseToEdit.value.courseID:null},syllabusID(){return this.courseToEdit?this.courseToEdit.value.syllabusID:null},sessionStr(){return this.sessionToEdit?new Date(this.sessionToEdit).toString():null},identifier(){return`${this.courseID}/${this.syllabusID}/${this.sessionStr}`}}),methods:{addNewCourseTeacher(){const t=W(this.teachers,L.teachers[0]);this.teachers.push({teacher:null,evalCount:t.evalCount})},removeCourseTeacher(t){this.teachers.splice(t,1)},addSlot(){const t=W(this.schedule,L.schedule[0]);this.schedule.push({slot:t.slot,room:t.room,day:null})},removeSlot(t){this.schedule.splice(t,1)},addExaminer(){const t=W(this.examiners,L.examiners[0]);this.examiners.push({teacher:null,part:null,totalMarks:t.totalMarks})},removeExaminer(t){this.examiners.splice(t,1)},addScrutinizer(){this.scrutinizers.push(o()({},L.scrutinizers[0]))},removeScrutinizer(t){this.scrutinizers.splice(t,1)},addInternal(){this.internals.push(o()({},L.internals[0]))},removeInternal(t){this.internals.splice(t,1)},updateEvaluationDetails(){Object(p["d"])(this.totalEvalCount,this.oldData.totalEvalCount)&&Object(p["d"])(this.consideredEvalCount,this.oldData.consideredEvalCount)&&Object(p["d"])(this.totalMarks,this.oldData.totalMarks)&&Object(p["d"])(this.perEvalWeight,this.oldData.perEvalWeight)&&Object(p["d"])(this.attendanceWeight,this.oldData.attendanceWeight)||this.callEditApi(`/courseSession/update/${this.identifier}`,{totalEvalCount:this.totalEvalCount,consideredEvalCount:this.consideredEvalCount,totalMarks:this.totalMarks,perEvalWeight:this.perEvalWeight,attendanceWeight:this.attendanceWeight},"Evaluation Details").then((()=>{this.oldData.totalEvalCount=this.totalEvalCount,this.oldData.consideredEvalCount=this.consideredEvalCount,this.oldData.totalMarks=this.totalMarks,this.oldData.perEvalWeight=this.perEvalWeight,this.oldData.attendanceWeight=this.attendanceWeight}))},updateList(t){let e=Object(p["a"])(this[t]);e&&!Object(p["b"])(e,L[t])||(e=[]);for(let s=0;s<e.length;s++)for(const t of Object.keys(e[s]))e[s][t]&&e[s][t].hasOwnProperty("value")&&(e[s][t]=e[s][t].value);Object(p["b"])(e,this.oldData[t])||this.callEditApi(`/courseSession/update/${this.identifier}/${t}`,e,$[t]).then((()=>{this.oldData[t]=e})).catch((()=>{}))},updateCourseSession(){this.updateEvaluationDetails(),this.updateList("teachers"),this.updateList("schedule"),this.updateList("examiners"),this.updateList("scrutinizers"),this.updateList("internals")},showErrorNotification(t){const e="Failed to load Course data";this.$q.notify({message:e,type:"negative"}),console.log(e),console.log(t.response)},loadCourseSessionData(){this.courseToEdit&&this.sessionToEdit&&this.fetchOldData("/courseSession/list",{courseID:this.courseID,syllabusID:this.syllabusID,session:this.sessionStr},"Course Session").then((()=>{this.resetForm(),this.courseDataLoaded=!0})).catch((t=>{t.doesNotExist?this.createCourseSession():this.showErrorNotification(t)}))},createCourseSession(){this.oldDataLoading=!0,this.$adminAPI.post("/courseSession/create",{courseID:this.courseID,syllabusID:this.syllabusID,session:this.sessionStr,totalEvalCount:6,consideredEvalCount:4,totalMarks:300,perEvalWeight:20,attendanceWeight:10}).then((t=>{this.oldData=t.data,this.oldDataLoading=!1,this.courseDataLoaded=!0,this.resetForm()})).catch((t=>this.showErrorNotification(t)))},resetForm(){this.loadOldDataIntoForm();for(const t of Object.keys(L))this[t]&&0!==this[t].length||(this[t]=Object(p["a"])(L[t]))}}},M=A,j=s("9989"),N=s("9c40"),R=s("0378"),F=s("eb85"),z=s("3b73"),V=s("27f9"),G=s("74f7"),U=Object(b["a"])(M,a,l,!1,null,"7df8067e",null);e["default"]=U.exports;f()(U,"components",{QPage:j["a"],QBtn:N["a"],QForm:R["a"],QSeparator:F["a"],QExpansionItem:z["a"],QInput:V["a"],QInnerLoading:G["a"]})}}]);