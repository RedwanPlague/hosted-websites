(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"514d":function(t,s,e){"use strict";e("dcbc")},"530e":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.info?e("div",{staticClass:"q-pa-sm column items-center"},[e("h6",[t._v("\n    "+t._s(t.info.courseID+" ("+t.info.courseTitle+") - Part "+t.info.part)+"\n  ")]),t.canSave?e("q-checkbox",{attrs:{label:"Edit"},model:{value:t.canEdit,callback:function(s){t.canEdit=s},expression:"canEdit"}}):t._e(),e("q-table",{staticClass:"table",attrs:{title:"Marks",data:t.students,columns:t.columns,"row-key":"studentID",separator:"cell",pagination:t.initialPagination,"table-header-class":"bg-primary text-white"},scopedSlots:t._u([{key:"body",fn:function(s){return[e("q-tr",{class:{bhul:t.info.hasForwarded&&s.row.editAccess},attrs:{props:s}},[e("q-td",{key:"studentID",attrs:{props:s}},[t._v("\n          "+t._s(s.row.studentID)+"\n        ")]),e("q-td",{key:"mark",attrs:{props:s}},[e("q-input",{attrs:{type:"number",value:s.row.mark,disable:!t.canEdit||!s.row.editAccess},on:{change:function(e){return t.updateMarks(e,s.row.studentID)}}})],1)],1)]}}],null,!1,1942375983)}),e("div",{staticClass:"btns"},[t.canSave?e("q-btn",{staticClass:"q-ma-md",attrs:{color:"primary",label:"Save"},on:{click:t.saveMarks}}):t._e(),t.info.hasForwarded?t._e():e("q-btn",{staticClass:"q-ma-md",attrs:{color:"primary",label:"Submit"},on:{click:function(s){t.submitting=!0}}}),e("q-dialog",{model:{value:t.submitting,callback:function(s){t.submitting=s},expression:"submitting"}},[e("q-card",[e("q-card-section",{staticClass:"row items-center"},[e("span",{staticClass:"q-ml-sm"},[t._v("Are you sure to submit?")])]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No",color:"primary"}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"yes",color:"primary"},on:{click:t.submitMarks}})],1)],1)],1)],1)],1):e("div",[t._v(t._s(t.info))])},i=[],r=e("ded3"),o=e.n(r),n=(e("ddb0"),e("2f62")),l=e("758b"),c={name:"ExaminerTable",setup(){return{}},data(){return{submitting:!1,loading:!0,canEdit:!1,probRolls:[],initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:null},columns:[{name:"studentID",label:"Student ID",field:"studentID",required:!0,align:"left",sortable:!0},{name:"mark",label:"Mark",field:"mark",align:"left"}]}},methods:{updateMarks(t,s){this.$store.commit("examiner/mutSingleMark",{studentID:s,mark:Number(t.target.value)})},async uploadMarks(t){try{const s=this.info.courseID,e=this.currentSession,a=this.info.part;if(this.probRolls=[],this.info.students.forEach((t=>{(t.mark<0||t.mark>this.info.totalMarks)&&this.probRolls.push(t.studentID)})),this.probRolls.length)return this.$q.notify({icon:"error",message:`Please recheck the marks of ${this.probRolls.join()}!`,position:"bottom-left",actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]}),!1;const i=this.info.students.map((t=>({studentID:t.studentID,mark:t.mark?t.mark:null}))),r="save"===t?"saved!":"forwarded!",o="save"===t?"saving!":"forwarding!",n=this.$q.notify({spinner:!0,message:o,group:!1,timeout:0,position:"bottom-left"});await l["b"].put(`teacher/examiner/${s}/${e}/${t}`,{part:a,students:i});return n({icon:"done",message:r,position:"bottom-left",spinner:!1,timeout:1500}),!0}catch(s){}},async saveMarks(){await this.uploadMarks("save")},async submitMarks(){const t=await this.uploadMarks("forward");t&&this.$store.commit("examiner/mutHasForwarded")}},computed:o()(o()({},Object(n["d"])("examiner",{info:"currentCourseInfo",currentSession:"currentSession"})),{},{students(){return this.info.students?this.info.students:[]},canSave(){for(const t of this.students)if(t.editAccess)return!0;return!1}}),watch:{async"$route.params"(t,s){this.$route.params.courseID&&this.$route.params.part&&(this.$store.commit("examiner/mutCurCourse",this.$route.params.courseID),this.$store.commit("examiner/mutCurPart",this.$route.params.part),this.loading=!0,this.$q.loading.show({delay:100}),this.courseLoading=!0,await this.$store.dispatch("examiner/fillCurrentCourse"),this.courseLoading=!1,consoloe.log(this.students),this.$q.loading.hide(),this.loading=!1)},info(t){this.loading=!1}},async created(){this.$q.loading.show({delay:100}),this.loading=!0,this.info||(await this.$store.dispatch("examiner/fillCurrentSession"),await this.$store.dispatch("examiner/fillCourses")),this.$store.commit("examiner/mutCurCourse",this.$route.params.courseID),this.$store.commit("examiner/mutCurPart",this.$route.params.part),await this.$store.dispatch("examiner/fillCurrentCourse"),this.loading=!1,this.$q.loading.hide()}},u=c,d=(e("514d"),e("2877")),m=e("8f8e"),p=e("eaac"),h=e("bd08"),f=e("db86"),b=e("27f9"),g=e("9c40"),k=e("24e8"),w=e("f09f"),v=e("a370"),$=e("4b7e"),q=e("7f67"),y=e("eebe"),C=e.n(y),x=Object(d["a"])(u,a,i,!1,null,"711c6468",null);s["default"]=x.exports;C()(x,"components",{QCheckbox:m["a"],QTable:p["a"],QTr:h["a"],QTd:f["a"],QInput:b["a"],QBtn:g["a"],QDialog:k["a"],QCard:w["a"],QCardSection:v["a"],QCardActions:$["a"]}),C()(x,"directives",{ClosePopup:q["a"]})},dcbc:function(t,s,e){}}]);