(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"857f":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"text-h5 q-my-md"},[e._v("\n    Edit Course Details\n  ")]),s("div",{staticClass:"row q-col-gutter-md"},[s("course-picker",{attrs:{classes:"col-6",label:"Course to Edit",required:""},on:{input:e.loadCourseSessionData},model:{value:e.courseToEdit,callback:function(t){e.courseToEdit=t},expression:"courseToEdit"}}),s("session-field",{attrs:{classes:"col-5",label:"Session",required:"",readonly:""},model:{value:e.sessionToEdit,callback:function(t){e.sessionToEdit=t},expression:"sessionToEdit"}}),e.courseToEdit?s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"refresh",size:"lg",dense:"",flat:""},on:{click:e.loadCourseSessionData}})],1):e._e()],1),e.courseDataLoaded&&e.courseToEdit?s("q-form",[s("q-separator"),s("q-expansion-item",{attrs:{label:"Evaluation Details","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-mb-md q-pt-md"},[s("q-input",{staticClass:"col-6",attrs:{label:"Total Evaluation Count",type:"number",outlined:"",rules:[function(){return!!e.totalEvalCount||"Please Fill this Field"}]},model:{value:e.totalEvalCount,callback:function(t){e.totalEvalCount=t},expression:"totalEvalCount"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Considered Evaluation Count",type:"number",outlined:"",rules:[function(){return!!e.consideredEvalCount||"Please Fill this Field"}]},model:{value:e.consideredEvalCount,callback:function(t){e.consideredEvalCount=t},expression:"consideredEvalCount"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Total Marks",type:"number",outlined:"",rules:[function(){return!!e.totalMarks||"Please Fill this Field"}]},model:{value:e.totalMarks,callback:function(t){e.totalMarks=t},expression:"totalMarks"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Per Evaluation Weight",type:"number",outlined:"",suffix:"%",rules:[function(){return!!e.perEvalWeight||"Please Fill this Field"}]},model:{value:e.perEvalWeight,callback:function(t){e.perEvalWeight=t},expression:"perEvalWeight"}}),s("q-input",{staticClass:"col-6",attrs:{label:"Attendance Weight",type:"number",suffix:"%",outlined:"",rules:[function(){return!!e.attendanceWeight||"Please Fill this Field"}]},model:{value:e.attendanceWeight,callback:function(t){e.attendanceWeight=t},expression:"attendanceWeight"}})],1)]),s("q-separator",{staticClass:"q-mb-lg"}),s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Course Teachers","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[e._l(e.teachers,(function(t,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-7 row"},[s("span",{staticClass:"col-1 text-h6"},[e._v(e._s(a+1)+".")]),s("teacher-picker",{attrs:{classes:"col-11",required:""},model:{value:t.teacher,callback:function(s){e.$set(t,"teacher",s)},expression:"item.teacher"}})],1),s("q-input",{staticClass:"col-4",attrs:{label:"Evaluation Count",type:"number",max:e.totalEvalCount,min:0,outlined:"",rules:[function(){return!!t.evalCount||"Please Enter Evaluation Count"}]},model:{value:t.evalCount,callback:function(s){e.$set(t,"evalCount",s)},expression:"item.evalCount"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.removeCourseTeacher(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.addNewCourseTeacher}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"}),s("q-separator"),s("q-expansion-item",{attrs:{label:"Fix Schedule","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[e._l(e.schedule,(function(t,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-5 row"},[s("span",{staticClass:"col-1 text-h6"},[e._v(e._s(a+1)+".")]),s("slot-picker",{attrs:{classes:"col-11"},model:{value:t.slot,callback:function(s){e.$set(t,"slot",s)},expression:"item.slot"}})],1),s("q-input",{staticClass:"col-3",attrs:{label:"Room",outlined:"",rules:[function(){return!!t.room||"Please Assign a Room"}]},model:{value:t.room,callback:function(s){e.$set(t,"room",s)},expression:"item.room"}}),s("day-of-week-picker",{staticClass:"col-3",attrs:{label:"Day of Week",required:""},model:{value:t.day,callback:function(s){e.$set(t,"day",s)},expression:"item.day"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.removeSlot(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.addSlot}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"}),s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Examiners","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"q-pb-md q-col-gutter-md"},[e._l(e.examiners,(function(t,a){return s("div",{key:a,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-7 row"},[s("span",{staticClass:"col-1 text-h6"},[e._v(e._s(a+1)+".")]),s("teacher-picker",{attrs:{classes:"col-11",label:"Examiner",required:""},model:{value:t.teacher,callback:function(s){e.$set(t,"teacher",s)},expression:"item.teacher"}})],1),s("q-input",{staticClass:"col-4",attrs:{label:"Part",outlined:"",rules:[function(){return!!t.part||"Please Assign a Part"}]},model:{value:t.part,callback:function(s){e.$set(t,"part",s)},expression:"item.part"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.removeExaminer(a)}}})],1)],1)})),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.addExaminer}})],1)],2)]),s("q-separator",{staticClass:"q-mb-lg"}),s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Scrutinizers","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-pt-sm"},e._l(e.scrutinizers,(function(t,a){return s("div",{key:a,staticClass:"row col-4"},[s("teacher-picker",{attrs:{classes:"col-11",label:"Scrutinizer",required:""},model:{value:t.teacher,callback:function(s){e.$set(t,"teacher",s)},expression:"item.teacher"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.removeScrutinizer(a)}}})],1)],1)})),0),s("div",{staticClass:"row q-pb-md"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.addScrutinizer}})],1)]),s("q-separator",{staticClass:"q-mb-lg"}),s("q-separator"),s("q-expansion-item",{attrs:{label:"Assign Result Access Holders","header-class":"text-h6 q-pl-none"}},[s("div",{staticClass:"row q-col-gutter-md q-pt-sm"},e._l(e.resultAccessHolders,(function(t,a){return s("div",{key:a,staticClass:"row col-4"},[s("teacher-picker",{attrs:{classes:"col-11",label:"Access Holder",required:""},model:{value:t.teacher,callback:function(s){e.$set(t,"teacher",s)},expression:"item.teacher"}}),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"delete",color:"primary",flat:"",dense:""},on:{click:function(t){return e.removeResultAccessHolder(a)}}})],1)],1)})),0),s("div",{staticClass:"row q-pb-md"},[s("div",{staticClass:"col-3"}),s("q-btn",{staticClass:"col-6",attrs:{color:"primary",outline:"",icon:"add",ripple:!1},on:{click:e.addResultAccessHolder}})],1)]),s("q-separator",{staticClass:"q-mb-lg"}),s("div",{staticClass:"col-12 q-mt-lg"},[s("q-btn",{attrs:{label:"Update",color:"primary",unelevated:"",loading:e.assignLoading},on:{click:e.updateCourseSession}}),s("q-btn",{attrs:{label:"Reset",color:"primary",flat:""},on:{click:e.resetForm}})],1)],1):e._e(),s("q-inner-loading",{attrs:{showing:e.oldDataLoading}}),s("div",{staticStyle:{"min-height":"200px"}})],1)},l=[],i=s("ded3"),o=s.n(i),r=(s("ddb0"),s("29b9")),n=s("e92d"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-select",{class:e.classes,attrs:{value:e.value,options:e.slotOptions,label:e.label,rules:[function(){return!e.required||!!e.value||"Please Select "+e.label}],"use-chips":e.multiple,multiple:e.multiple,clearable:e.multiple,outlined:""},on:{input:function(t){return e.$emit("input",t)}}})},u=[],d=s("dce8"),h=s("a796"),p=s("0286"),m={name:"SlotPicker",props:{label:{type:String,default:"Slot"},value:{type:[Object,Array,Number,String],default:null},classes:{type:[Object,String]},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},data(){return{slotOptions:[]}},methods:{fixValue(e){if("string"===typeof e||"number"===typeof e){const t=this.slotOptions.filter((t=>Object(p["c"])(t.value,e)))[0];this.$emit("input",t)}},fetchSlots(){Object(d["a"])("/slot/list",null,"Slots").then((e=>{this.slotOptions=e.data.map((e=>({value:e.id,label:`(${e.id}) ${Object(h["d"])(e.startingTime)} - ${e.duration} minutes`}))),this.fixValue(this.value)}))}},created(){this.fetchSlots()},watch:{value:{handler(e){this.fixValue(e)}}}},v=m,b=s("2877"),C=s("ddd8"),f=s("eebe"),q=s.n(f),g=Object(b["a"])(v,c,u,!1,null,"680ded20",null),E=g.exports;q()(g,"components",{QSelect:C["a"]});var y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-select",{class:e.classes,attrs:{value:e.value,label:e.label,options:e.dayOptions,rules:[function(){return!e.required||!!e.value||"Please Select "+e.label}],"use-chips":e.multiple,multiple:e.multiple,clearable:e.multiple,outlined:""},on:{input:function(t){return e.$emit("input",t)}}})},k=[];const x=[{value:"sat",label:"Saturday"},{value:"sun",label:"Sunday"},{value:"mon",label:"Monday"},{value:"tue",label:"Tuesday"},{value:"wed",label:"Wednesday"},{value:"thu",label:"Thursday"},{value:"fri",label:"Friday"}];var S={name:"DayOfWeekPicker",props:{label:{type:String,default:"Day"},value:{type:[Object,Array,String],default:null},classes:{type:[Object,String]},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},data(){return{dayOptions:x}},methods:{fixValue(e){if("string"===typeof e){const t=this.dayOptions.filter((t=>t.value===e))[0];this.$emit("input",t)}}},created(){this.fixValue(this.value)},watch:{value:{handler(e){this.fixValue(e)}}}},D=S,T=Object(b["a"])(D,y,k,!1,null,"d176918e",null),w=T.exports;q()(T,"components",{QSelect:C["a"]});var O=s("567a"),W=s("88f5");const A=(e,t)=>e.length>0?e[e.length-1]:t,$={teachers:"Course Teachers",schedule:"Course Schedule",examiners:"Examiners",resultAccessHolders:"Result Access Holders",scrutinizers:"Scrutinizers"},j={teachers:[{teacher:null,evalCount:null}],schedule:[{slot:null,room:null,day:null}],examiners:[{teacher:null,part:null}],resultAccessHolders:[{teacher:null}],scrutinizers:[{teacher:null}]};var P={name:"CourseAssignment",components:{SessionField:O["a"],DayOfWeekPicker:w,SlotPicker:E,TeacherPicker:n["a"],CoursePicker:r["a"]},mixins:[W["a"]],data(){return{courseToEdit:null,sessionToEdit:null,courseDataLoaded:!1,totalEvalCount:null,consideredEvalCount:null,totalMarks:null,perEvalWeight:null,attendanceWeight:null,teachers:j.teachers,schedule:j.schedule,examiners:j.examiners,resultAccessHolders:j.resultAccessHolders,scrutinizers:j.scrutinizers,assignLoading:!1}},computed:{courseID(){return this.courseToEdit?this.courseToEdit.value.courseID:null},syllabusID(){return this.courseToEdit?this.courseToEdit.value.syllabusID:null},sessionStr(){return this.sessionToEdit?Object(h["c"])(this.sessionToEdit).toString():null},identifier(){return`${this.courseID}/${this.syllabusID}/${this.sessionStr}`}},methods:{addNewCourseTeacher(){const e=A(this.teachers,j.teachers[0]);this.teachers.push({teacher:null,evalCount:e.evalCount})},removeCourseTeacher(e){this.teachers.splice(e,1)},addSlot(){const e=A(this.schedule,j.schedule[0]);this.schedule.push({slot:e.slot,room:e.room,day:null})},removeSlot(e){this.schedule.splice(e,1)},addExaminer(){this.examiners.push(o()({},j.examiners[0]))},removeExaminer(e){this.examiners.splice(e,1)},addScrutinizer(){this.scrutinizers.push(o()({},j.scrutinizers[0]))},removeScrutinizer(e){this.scrutinizers.splice(e,1)},addResultAccessHolder(){this.resultAccessHolders.push(o()({},j.resultAccessHolders[0]))},removeResultAccessHolder(e){this.resultAccessHolders.splice(e,1)},updateEvaluationDetails(){Object(p["c"])(this.totalEvalCount,this.oldData.totalEvalCount)&&Object(p["c"])(this.consideredEvalCount,this.oldData.consideredEvalCount)&&Object(p["c"])(this.totalMarks,this.oldData.totalMarks)&&Object(p["c"])(this.perEvalWeight,this.oldData.perEvalWeight)&&Object(p["c"])(this.attendanceWeight,this.oldData.attendanceWeight)||this.callEditApi(`/courseSession/update/${this.identifier}`,{totalEvalCount:this.totalEvalCount,consideredEvalCount:this.consideredEvalCount,totalMarks:this.totalMarks,perEvalWeight:this.perEvalWeight,attendanceWeight:this.attendanceWeight},"Evaluation Details").then((()=>{this.oldData.totalEvalCount=this.totalEvalCount,this.oldData.consideredEvalCount=this.consideredEvalCount,this.oldData.totalMarks=this.totalMarks,this.oldData.perEvalWeight=this.perEvalWeight,this.oldData.attendanceWeight=this.attendanceWeight}))},updateList(e){let t=Object(p["a"])(this[e]);t&&!Object(p["b"])(t,j[e])||(t=[]);for(let s=0;s<t.length;s++)for(const e of Object.keys(t[s]))t[s][e]&&t[s][e].hasOwnProperty("value")&&(t[s][e]=t[s][e].value);Object(p["b"])(t,this.oldData[e])||this.callEditApi(`/courseSession/update/${this.identifier}/${e}`,t,$[e]).then((()=>{this.oldData[e]=t})).catch((()=>{}))},updateCourseSession(){this.updateEvaluationDetails(),setTimeout((()=>this.updateList("teachers")),200),setTimeout((()=>this.updateList("schedule")),400),setTimeout((()=>this.updateList("examiners")),600),setTimeout((()=>this.updateList("scrutinizers")),800),setTimeout((()=>this.updateList("resultAccessHolders")),1e3)},showErrorNotification(e){const t="Failed to load Course data";this.$q.notify({message:t,type:"negative"}),console.log(t),console.log(e.response)},loadCourseSessionData(){this.courseToEdit&&this.sessionToEdit&&this.fetchOldData("/courseSession/list",{courseID:this.courseID,syllabusID:this.syllabusID,session:this.sessionStr},"Course Session").then((()=>{this.resetForm(),this.courseDataLoaded=!0})).catch((e=>{e.doesNotExist?this.createCourseSession():this.showErrorNotification(e)}))},createCourseSession(){this.oldDataLoading=!0,this.$adminAPI.post("/courseSession/create",{courseID:this.courseID,syllabusID:this.syllabusID,session:this.sessionStr,totalEvalCount:6,consideredEvalCount:4,totalMarks:300,perEvalWeight:20,attendanceWeight:10}).then((e=>{this.oldData=e.data,this.oldDataLoading=!1,this.courseDataLoaded=!0,this.resetForm()})).catch((e=>this.showErrorNotification(e)))},resetForm(){this.loadOldDataIntoForm();for(const e of Object.keys(j))this[e]&&0!==this[e].length||(this[e]=Object(p["a"])(j[e]))}}},F=P,_=s("9989"),I=s("9c40"),z=s("0378"),H=s("eb85"),L=s("3b73"),M=s("27f9"),Q=s("74f7"),R=Object(b["a"])(F,a,l,!1,null,"da5d70e8",null);t["default"]=R.exports;q()(R,"components",{QPage:_["a"],QBtn:I["a"],QForm:z["a"],QSeparator:H["a"],QExpansionItem:L["a"],QInput:M["a"],QInnerLoading:Q["a"]})}}]);