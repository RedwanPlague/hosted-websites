(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"1d64":function(e,t,s){},"6eff":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{directives:[{name:"show",rawName:"v-show",value:e.pageLoaded,expression:"pageLoaded"}],staticClass:"container"},[s("h5",[e._v(e._s(e.course_data.session)+" "+e._s(e.course_data.courseID)+": "+e._s(e.course_data.courseName))]),s("q-dialog",{model:{value:e.csvButton,callback:function(t){e.csvButton=t},expression:"csvButton"}},[s("q-card",{staticStyle:{width:"400px"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("Upload CSV File")])]),s("q-card-section",{staticClass:"q-pt-md"},[s("input",{attrs:{type:"file",id:"csvFile",accept:".csv"}})]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Upload",color:"primary","no-caps":""},on:{click:e.readFile}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancel",color:"primary",flat:"","no-caps":""}})],1)],1)],1),s("div",{staticClass:"button-row"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showEditButton,expression:"showEditButton"}],staticClass:"col"},[s("q-btn",{attrs:{icon:e.buttonIcon,disable:e.editButtonLoading,size:"md",color:"primary",label:e.buttonText},on:{click:e.toggleEditMode}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.course_data.hasForwarded,expression:"!course_data.hasForwarded"}],staticClass:"col csv-button"},[s("q-btn",{attrs:{size:"md",color:"primary",icon:"upload",label:"Import CSV"},on:{click:function(t){e.csvButton=!0}}})],1)]),s("div",{staticClass:"table q-pa-lg"},[s("q-table",{attrs:{title:"Course Assessment",data:e.student_data,columns:e.columns,separator:"cell",pagination:e.pagination,filter:e.studentFilter,"row-key":function(e){return e.student_id},selection:"multiple",selected:e.selected_students},on:{"update:pagination":function(t){e.pagination=t},"update:selected":function(t){e.selected_students=t}},scopedSlots:e._u([{key:"top",fn:function(){return[s("div",{staticClass:"q-table__title"},[e._v("Course Assessment")]),s("q-space"),s("q-input",{attrs:{outlined:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.studentFilter,callback:function(t){e.studentFilter=t},expression:"studentFilter"}})]},proxy:!0},{key:"header",fn:function(t){return[s("q-tr",{attrs:{props:t}},e._l(t.cols,(function(a){return s("q-th",{key:a.name,attrs:{props:t}},[e._v("\n            "+e._s(a.label)+"\n          ")])})),1)]}},{key:"body",fn:function(t){return[s("q-tr",{attrs:{props:t}},[s("q-td",{key:"student_id",attrs:{props:t}},[e._v("\n          "+e._s(t.row.student_id)+"\n        ")]),s("q-td",{key:"student_name",attrs:{props:t}},[e._v("\n          "+e._s(t.row.student_name)+"\n        ")]),e._l(e.course_data.evalCount,(function(a){return s("q-td",{key:"eval_"+a,attrs:{props:t}},[s("q-input",{attrs:{type:"number",min:"0",autofocus:"",dense:"",disable:!t.row.editAccess||!e.editMode,"input-class":"text-center"},model:{value:t.row["eval_"+a],callback:function(s){e.$set(t.row,"eval_"+a,s)},expression:"props.row['eval_'+i]"}})],1)})),s("q-td",{key:"attendance",attrs:{props:t}},[s("q-input",{attrs:{type:"number",min:"0",autofocus:"",dense:"",disable:!t.row.editAccess||!e.editMode,"input-class":"text-center"},model:{value:t.row.attendance,callback:function(s){e.$set(t.row,"attendance",s)},expression:"props.row.attendance"}})],1)],2)]}}])}),s("div",{staticClass:"row q-pa-lg"},[s("q-input",{attrs:{outlined:"",dense:"",label:"Total Classes:",type:"number",min:"0",disable:!e.editMode},model:{value:e.classCount,callback:function(t){e.classCount=t},expression:"classCount"}}),s("q-space"),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.course_data.hasForwarded,expression:"!course_data.hasForwarded"}]},[s("q-btn",{staticStyle:{height:"40px"},attrs:{"no-caps":"",icon:"check_circle",size:"md",color:"primary",label:"Submit Evalution"},on:{click:function(t){e.submitFlag=!0}}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.submitFlag,callback:function(t){e.submitFlag=t},expression:"submitFlag"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("span",{staticClass:"q-ml-sm"},[e._v("Are you sure you want to submit your Term evaluation for "+e._s(e.course_data.courseID)+": "+e._s(e.course_data.courseName)+"?")])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Yes, Submit Evaluation",color:"primary"},on:{click:e.submitButtonClicked}})],1)],1)],1)],1)},o=[],n=s("ded3"),i=s.n(n),r=s("2f62"),l=s("5935");const c=e=>{try{const t=e.split("\n");t.forEach(((e,s)=>{t[s]=e.split(",")}));const s=t.shift(),a=[];return t.forEach((e=>{const t={};s.forEach(((s,a)=>{t[s]=e[a]})),a.push(t)})),a}catch(t){throw new Error(t)}};var d=c;const{mapGetters:u,mapActions:p}=Object(r["a"])("courseEval");let m={name:"eval_",label:"Evaluation - ",align:"center",field:"eval_",classes:"bg-grey-1",headerClasses:"bg-primary text-white",sortable:!0};var h={name:"CourseEvaluationPage",computed:i()(i()(i()({},u(["course_data","selected_students","showEditButton"])),Object(l["b"])("courseEval",["student_data"])),{},{classCount:{get(){return this.course_data.classCount},set(e){this.setClassCount(e)}}}),async created(){this.pageLoaded=!1,this.$q.loading.show({delay:100,message:"Loading...",messageColor:"white"}),await this.fetchCourseDetails({courseID:this.$route.params.courseID,session:this.$route.params.courseSession});for(let e=1;e<=this.course_data.evalCount;e++){let t=i()({},m);t.name+=e,t.label+=e+" (20)",t.field+=e,this.columns.splice(this.columns.length-1,0,t)}this.$q.loading.hide(),this.pageLoaded=!0},watch:{async"$route.params"(e,t){this.$route.params.courseID&&await this.fetchCourseDetails({courseID:this.$route.params.courseID,session:this.$route.params.courseSession})}},methods:i()(i()({},p(["setClassCount","fetchCourseDetails","saveStudentData","updateEvaluationTable","studentDataFilledCheck","setHasForwarded"])),{},{loadCSVData(e){let t;try{t=d(e)}catch(s){return console.log(s),!1}return!(!t||!this.updateEvaluationTable(t))&&(this.saveStudentData(),!0)},readFile(){const e=document.getElementById("csvFile").files[0];if(!e||"csv"!==e.name.split(".").pop())return void this.$q.notify({icon:"error",message:"Error: Please upload a .csv file",position:"bottom-left",actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]});const t=this.$q.notify({message:"Uploading File",position:"bottom-left",group:!1,timeout:0,spinner:!0});let s=new FileReader;s.readAsText(e),s.onload=e=>{const s=this.loadCSVData(e.target.result);t(s?{icon:"done",spinner:!1,message:"Evaluation table updated",timeout:1500}:{icon:"error",spinner:!1,message:"Error: Failed parsing CSV file, please check data format",actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]})}},async submitButtonClicked(e){e.preventDefault(),this.editMode&&await this.toggleEditMode(e);const t=this.$q.notify({message:"Saving Evaluation",position:"bottom-left",group:!1,timeout:0,spinner:!0}),s=await this.studentDataFilledCheck();s?(await this.setHasForwarded(),await this.saveStudentData(),t({icon:"done",spinner:!1,message:"Result Submitted",timeout:1500})):t({icon:"error",spinner:!1,message:"Error: Please fill all table cells",actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]})},async toggleEditMode(e){if(e.preventDefault(),this.editMode=!this.editMode,console.log("edit mode: "+this.editMode),!this.editMode){this.editButtonLoading=!0;const e=this.$q.notify({message:"Saving Evaluation",position:"bottom-left",group:!1,timeout:0,spinner:!0}),t=await this.saveStudentData();this.editButtonLoading=!1,t.error?(this.editMode=!0,e({icon:"error",spinner:!1,message:"Error: "+t.error,actions:[{label:"Dismiss",color:"yellow",handler:()=>{}}]})):e({icon:"done",spinner:!1,message:"Progress Saved",timeout:1500})}this.editMode?(this.buttonIcon="done",this.buttonText="Save",this.course_data.hasForwarded||this.columns.forEach(((e,t)=>{t>=2&&(e.classes="bg-white-1")}))):(this.buttonIcon="edit",this.buttonText="Edit",this.columns.forEach(((e,t)=>{t>=2&&(e.classes="bg-grey-1")})))}}),data(){return{pageLoaded:"",editButtonLoading:!1,csvButton:!1,studentFilter:"",submitFlag:!1,editMode:!1,buttonIcon:"edit",buttonText:"Edit",pagination:{sortBy:"student_id",page:1,rowsPerPage:0,ascending:!0},columns:[{name:"student_id",label:"Student ID",align:"center",field:"student_id",classes:"bg-grey-1",headerClasses:"bg-primary text-white",sortable:!0,sort:(e,t)=>parseInt(e.substring(1),10)-parseInt(t.substring(1),10)},{name:"student_name",label:"Student Name",align:"center",field:"student_name",classes:"bg-grey-1",headerClasses:"bg-primary text-white",sortable:!0},{name:"attendance",label:"Attendance Count",align:"center",field:"attendance",classes:"bg-grey-1",headerClasses:"bg-primary text-white",sortable:!0}]}}},b=h,g=(s("da58"),s("2877")),v=s("9989"),f=s("24e8"),w=s("f09f"),_=s("a370"),y=s("4b7e"),C=s("9c40"),q=s("eaac"),E=s("2c91"),k=s("27f9"),x=s("0016"),F=s("bd08"),S=s("357e"),D=s("db86"),I=s("7f67"),B=s("eebe"),$=s.n(B),M=Object(g["a"])(b,a,o,!1,null,"52691464",null);t["default"]=M.exports;$()(M,"components",{QPage:v["a"],QDialog:f["a"],QCard:w["a"],QCardSection:_["a"],QCardActions:y["a"],QBtn:C["a"],QTable:q["a"],QSpace:E["a"],QInput:k["a"],QIcon:x["a"],QTr:F["a"],QTh:S["a"],QTd:D["a"]}),$()(M,"directives",{ClosePopup:I["a"]})},da58:function(e,t,s){"use strict";s("1d64")}}]);